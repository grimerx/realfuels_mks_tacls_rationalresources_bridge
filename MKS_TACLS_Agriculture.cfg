// MKS_TACLS_Agriculture.cfg
// Converts MKS agricultural modules to produce TAC-LS resources
// Allows greenhouses to output Food, Water, and Oxygen instead of generic Supplies
// Author: Auto-generated integration patch
// Last Updated: December 2025

// Standard MKS Agricultural Module - TAC-LS version
@PART[*]:HAS[@MODULE[ModuleResourceConverter]:HAS[#ConverterName = Agriculture]]:NEEDS[TACLifeSupport,UmbraSpaceIndustries/MKS,RationalResources]:FOR[zzz_MKS_TACLS_Agriculture]
{
    // Create TAC-LS agricultural converter
    MODULE:NEEDS[TACLifeSupport]
    {
        name = ModuleResourceConverter
        ConverterName = Agriculture (TAC-LS)
        StartActionName = Start Agriculture
        StopActionName = Stop Agriculture
        ToggleActionName = Toggle Agriculture
        AutoShutdown = true
        GeneratesHeat = false
        UseSpecialistBonus = true
        SpecialistEfficiencyFactor = 0.5
        SpecialistBonusBase = 0.05
        ExperienceEffect = ScienceSkill
        EfficiencyBoost = 1
        
        INPUT_RESOURCE
        {
            ResourceName = Substrate
            Ratio = 0.0000625  // Small consumption
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = Water
            Ratio = 0.000325  // ~5 kg/day per Kerbal equivalent
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = Fertilizer
            Ratio = 0.0000166  // Trace amounts
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = ElectricCharge
            Ratio = 1.5  // Power consumption
            FlowMode = ALL_VESSEL
        }
        
        OUTPUT_RESOURCE
        {
            ResourceName = Food
            Ratio = 0.0000375  // ~0.6 kg/day per converter per Kerbal
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
        OUTPUT_RESOURCE
        {
            ResourceName = Oxygen
            Ratio = 0.0000625  // ~1 kg/day per converter
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
        OUTPUT_RESOURCE
        {
            ResourceName = Water
            Ratio = 0.0000188  // Recycling output
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
    }
}

// Large Agricultural Module (Tundra version)
@PART[Tundra-Agriculture]:NEEDS[TACLifeSupport,UmbraSpaceIndustries/MKS,RationalResources]:FOR[zzz_MKS_TACLS_Agriculture]
{
    MODULE:NEEDS[TACLifeSupport]
    {
        name = ModuleResourceConverter
        ConverterName = Agriculture (TAC-LS) - Large
        StartActionName = Start Agriculture
        StopActionName = Stop Agriculture
        ToggleActionName = Toggle Agriculture
        AutoShutdown = true
        GeneratesHeat = false
        UseSpecialistBonus = true
        SpecialistEfficiencyFactor = 0.5
        SpecialistBonusBase = 0.05
        ExperienceEffect = ScienceSkill
        EfficiencyBoost = 1
        
        INPUT_RESOURCE
        {
            ResourceName = Substrate
            Ratio = 0.000250  // Scaled for larger output
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = Water
            Ratio = 0.00130  // ~20 kg/day for 4 Kerbals
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = Fertilizer
            Ratio = 0.0000663  // Scaled trace consumption
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = ElectricCharge
            Ratio = 6.0  // Higher power for larger unit
            FlowMode = ALL_VESSEL
        }
        
        OUTPUT_RESOURCE
        {
            ResourceName = Food
            Ratio = 0.00015  // Supports ~2.5 Kerbals fully
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
        OUTPUT_RESOURCE
        {
            ResourceName = Oxygen
            Ratio = 0.00025  // Proportional oxygen
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
        OUTPUT_RESOURCE
        {
            ResourceName = Water
            Ratio = 0.0000750  // Recycled water
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
    }
}

// Waste Recycler Module - Converts TAC waste to reusable resources
@PART[*]:HAS[@MODULE[ModuleResourceConverter]:HAS[#ConverterName = *Recycl*]]:NEEDS[TACLifeSupport,UmbraSpaceIndustries/MKS]:FOR[zzz_MKS_TACLS_Agriculture]
{
    MODULE:NEEDS[TACLifeSupport]
    {
        name = ModuleResourceConverter
        ConverterName = TAC Recycler
        StartActionName = Start Recycling
        StopActionName = Stop Recycling
        ToggleActionName = Toggle Recycling
        AutoShutdown = true
        GeneratesHeat = false
        UseSpecialistBonus = true
        SpecialistEfficiencyFactor = 0.25
        SpecialistBonusBase = 0.05
        ExperienceEffect = ScienceSkill
        
        INPUT_RESOURCE
        {
            ResourceName = WasteWater
            Ratio = 0.000325  // Process waste water
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = Waste
            Ratio = 0.0000625  // Process organic waste
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = ElectricCharge
            Ratio = 0.6  // Recycling power
            FlowMode = ALL_VESSEL
        }
        
        OUTPUT_RESOURCE
        {
            ResourceName = Water
            Ratio = 0.000260  // ~70% recovery efficiency
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
        OUTPUT_RESOURCE
        {
            ResourceName = Mulch
            Ratio = 0.0000312  // Unusable byproduct (dump or use for agriculture)
            DumpExcess = true
            FlowMode = STAGE_PRIORITY_FLOW
        }
    }
}

// Electrolysis Module - Produces Oxygen from Water using Rational Resources
@PART[*]:HAS[@MODULE[ModuleResourceConverter]:HAS[#ConverterName = *Sabatier*]]:NEEDS[TACLifeSupport,UmbraSpaceIndustries/MKS,RationalResources]:FOR[zzz_MKS_TACLS_Agriculture]
{
    MODULE:NEEDS[TACLifeSupport]
    {
        name = ModuleResourceConverter
        ConverterName = Electrolysis (TAC-LS)
        StartActionName = Start Electrolysis
        StopActionName = Stop Electrolysis
        ToggleActionName = Toggle Electrolysis
        AutoShutdown = true
        GeneratesHeat = false
        UseSpecialistBonus = true
        SpecialistEfficiencyFactor = 0.25
        SpecialistBonusBase = 0.1
        ExperienceEffect = ScienceSkill
        
        INPUT_RESOURCE
        {
            ResourceName = Water
            Ratio = 0.000325  // Splits water
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = ElectricCharge
            Ratio = 2.5  // Power-intensive process
            FlowMode = ALL_VESSEL
        }
        
        OUTPUT_RESOURCE
        {
            ResourceName = Oxygen
            Ratio = 0.000162  // Primary output
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
        OUTPUT_RESOURCE
        {
            ResourceName = LqdHydrogen
            Ratio = 0.0000812  // Byproduct (can be used for fuel)
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
    }
}

// Compost Module - Converts Waste to Fertilizer for MKS agriculture
@PART[*]:HAS[@MODULE[ModuleResourceConverter]:HAS[#ConverterName = *Compost*]]:NEEDS[TACLifeSupport,UmbraSpaceIndustries/MKS]:FOR[zzz_MKS_TACLS_Agriculture]
{
    MODULE:NEEDS[TACLifeSupport]
    {
        name = ModuleResourceConverter
        ConverterName = Composting
        StartActionName = Start Composting
        StopActionName = Stop Composting
        ToggleActionName = Toggle Composting
        AutoShutdown = true
        GeneratesHeat = false
        UseSpecialistBonus = true
        SpecialistEfficiencyFactor = 0.25
        SpecialistBonusBase = 0.05
        ExperienceEffect = ScienceSkill
        
        INPUT_RESOURCE
        {
            ResourceName = Waste
            Ratio = 0.00003125  // Slow conversion
            FlowMode = STAGE_PRIORITY_FLOW
        }
        INPUT_RESOURCE
        {
            ResourceName = ElectricCharge
            Ratio = 0.1  // Minimal power
            FlowMode = ALL_VESSEL
        }
        
        OUTPUT_RESOURCE
        {
            ResourceName = Fertilizer
            Ratio = 0.0000156  // ~50% mass conversion
            DumpExcess = false
            FlowMode = STAGE_PRIORITY_FLOW
        }
    }
}
